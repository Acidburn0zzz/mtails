[[!meta title="Migrating from Claws Mail to Icedove"]]

Tails is replacing <span class="application">[[Claws Mail]]</span> with
<span class="application">[[Icedove]]</span> as its email client.

  - In Tails 1.7, <span class="application">Icedove</span> is available
    as a technology preview.
  - In Tails 1.8 (2015-12-15), <span class="application">Icedove</span>
    is the default email client in Tails and all users are encouraged to migrate to
    <span class="application">Icedove</span>.
  - In Tails 1.9 (2016-01-26), <span class="application">Claws Mail</span>
    will be removed from Tails.

If you have been using Claws Mail and activated its persistence feature,
the following instructions explain how to migrate your data to Icedove.

We recommend you do the migration before launching Icedove for the first
time and migrate, in this order:

  - [[Your emails saved in the persistent storage|claws_mail_to_icedove#mailboxes]]
  - [[Your email account settings|claws_mail_to_icedove#settings]]
  - [[Your address book|claws_mail_to_icedove#address_book]]

<a id="mailboxes"></a>

Migrate your emails saved in the persistent storage
===================================================

1. To know if you are using the IMAP or the POP protocol, choose <span class="menuchoice">
   <span class="guimenu">Configuration</span>&nbsp;▸
   <span class="guimenuitem">Edit accounts&hellip;</span></span> in <span
   class="application">Claws Mail</span> and refer
   to the <span class="guilabel">Protocol</span> column in the list of
   accounts.

   - If you use IMAP, your emails are stored on the remote email server and
     you can skip this section and start [[migrating your email account
     settings|claws_mail_to_icedove#settings]].

   - If you use POP and have emails saved in the persistent storage, we
     propose in the following steps a script to migrate your emails from Claws Mail to Icedove.

1. Start Tails and [[set up an administration password|first_steps/startup_options/administration_password]].

1. Choose <span class="menuchoice"><span class="guimenu">Applications</span>&nbsp;▸
   <span class="guisubmenu">Accessories</span>&nbsp;▸
   <span class="guimenuitem">Terminal</span></span> to open a terminal.

1. Execute the following command to install the `nmh` package:

       sudo apt-get update ; sudo apt-get install nmh

1. Execute the following command to download the migration script:

       wget https://tails.boum.org/misc/claws_to_icedove.sh

1. Execute the following command to run the migration script:

       bash claws_to_icedove.sh

   <div class="note">
   <p>If you had started Icedove already, the script might propose you to
   back up the existing Icedove email folders before doing the
   migration. If you have valuable data in these folders, you can access
   these folders again after the migration by doing the following:</p>

   <ol>

   <li>Choose
   <span class="menuchoice">
     <span class="guimenu">[[!img icedove/menu.png alt="Menu" class=symbolic link=no]]</span>&nbsp;▸
     <span class="guisubmenu">Preferences</span>&nbsp;▸
     <span class="guimenuitem">Account Settings</span>
   </span> in Icedove.</li>

   <li>Click <span class="button">Browse&hellip;</span> in the
   <span class="guilabel">Message Storage</span> section of the
   <span class="guilabel">Local Folders</span> settings.</li>

   <li>Navigate to <span class="filename">/home/amnesia/.icedove/profile.default/Mail.</li>

   <li>Open the <span class="filename">Local Folders Backup</span>
   folder that matches the date and time when you first run the
   script.</li>

   </ol>

This script also supports well the migration of GPG signed and encrypted emails.

Note that the script does not support migrating multiple MH boxes.

<a id="settings"></a>

Migrate your email account settings
===================================

In order to migrate your email accounts you will need to use Icedove's account
creation wizard, then you'll be able to retrieve and send your emails through Icedove.

Please beware that account passwords are stored by ClawsMail in an encrypted
fashion and cannot be retrieved or migrated automatically. You should remember them.

To start <span class="application">Icedove</span> choose
<span class="menuchoice">
  <span class="guimenu">Applications</span>&nbsp;▸
  <span class="guisubmenu">Internet</span>&nbsp;▸
  <span class="guimenuitem">Icedove</span>
</span>.

When you start Icedove for the first time, the account creation wizard
will pop up automatically. Please enter your credentials: name, email address,
password and chose the protocol, probably IMAP, then click "Continue".

You will be presented the Torbirdy screen, indicating that the next steps will
also need to be manually configured. Click Ok.

The account settings window now presents you with the server settings. Here,
you will need to adjust the server name, user name and security settings for
retrieving your email.

Then, you will be able to click on "Outgoing server" and adjust the settings
for sending email.

One can verify the previous account settings in Claws Mail's Configuration menu.
Fire up Claws Mail, click on Configuration, then account settings, then Edit.

If you need to add multiple accounts, click on Account Actions, then Add Mail Account.

When done, click OK. This will close the Account Settings window.

Enigmail will now ask you if you need help. If you use GPG, you can now either
generate a new encryption key or import one from your Persistent volume.

You can now start using Icedove.

For further configuration options please refer to the Icedove documentation XXX.

<a id="address_book"></a>

Migrate your address book
=========================

In Claws Mail, access the Address book through the main menu "Extras" -> Address book
or press Shift+Ctrl+A. Select an address book on the left then click on "Extras" ->
Export LDIF. Select a place where to store the file, then click Next. You do not need
to add a Suffix, so just click Next, then Close.

In Icedove, simply click the Address book icon. In the address book window, click "Tools"
-> Import, select "Address Books" then click Next. Choose "Text file (LDIF, .tab, .csv, .txt)".
Now click Next and navigate to the file you have saved from ClawsMail. Click Ok, you're done.

You can repeat this for every address book you have created in ClawsMail.

Clean up
========

Once happy, once tested that everything works, you can delete all files related to ClawsMail
if you wish to do so: `rm -rf $HOME/Mail`

You may also uninstall `nmh`: `apt-get remove nmh`.
