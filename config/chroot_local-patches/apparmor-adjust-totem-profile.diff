diff -Naur etc/apparmor.d.orig/abstractions/totem etc/apparmor.d/abstractions/totem
--- a/etc/apparmor.d/abstractions/totem	2014-08-28 15:51:48.000000000 +0000
+++ b/etc/apparmor.d/abstractions/totem	2016-11-05 14:58:38.676759826 +0000
@@ -30,6 +30,10 @@
 
   /usr/lib/@{multiarch}/gstreamer[0-9].[0-9]/gstreamer-[0-9].[0-9]/gst-plugin-scanner Cix -> gst_plugin_scanner,
 
+  owner @{HOME}/.cache/gstreamer-[0-9]*.[0-9]*/registry.*.bin rw,
+  owner @{HOME}/.cache/gstreamer-[0-9]*.[0-9]*/registry.*.bin.tmp* rw,
   owner @{HOME}/.cache/tracker/meta.db k,
   owner @{HOME}/.cache/tracker/meta.db-shm k,
+  owner @{HOME}/.config/totem/** rwk,
   owner @{HOME}/.local/share/grilo-plugins/*.db k,
+  owner @{HOME}/.local/share/gvfs-metadata/** r,
diff -Naur etc/apparmor.d.orig/usr.bin.totem etc/apparmor.d/usr.bin.totem
--- a/etc/apparmor.d/usr.bin.totem	2015-11-14 13:39:59.000000000 +0000
+++ b/etc/apparmor.d/usr.bin.totem	2016-11-05 14:57:21.817646742 +0000
@@ -9,16 +9,20 @@
   #include <abstractions/python>
   #include <abstractions/totem>
 
+  # We wrap Totem to run it with torsocks
+  /etc/tor/torsocks.conf r,
+
   # Maybe in an abstraction?
   /usr/include/**/pyconfig.h r,
 
   /usr/bin/totem r,
   /dev/sr* r,
 
-  # Allow read and write on anything in @{HOME}. Lenient, but
+  # Allow read and write on almost anything in @{HOME}. Lenient, but
   # private-files-strict is in effect.
   #include <abstractions/private-files-strict>
-  owner @{HOME}/** rw,
+  owner @{HOME}/[a-zA-Z0-9]*    rw,
+  owner @{HOME}/[a-zA-Z0-9]*/** rw,
 
   owner /{,var/}run/user/*/dconf/user w,
   owner /{,var/}run/user/*/at-spi2-*/   rw,
diff -Naur etc/apparmor.d.orig/usr.bin.totem-previewers etc/apparmor.d/usr.bin.totem-previewers
--- a/etc/apparmor.d/usr.bin.totem-previewers	2014-10-14 23:22:57.000000000 +0000
+++ b/etc/apparmor.d/usr.bin.totem-previewers	2016-11-05 14:57:21.817646742 +0000
@@ -6,10 +6,11 @@
 /usr/bin/totem-video-thumbnailer {
   #include <abstractions/totem>
 
-  # Allow read on anything in @{HOME}. Lenient, but private-files-strict is in
+  # Allow read on almost anything in @{HOME}. Lenient, but private-files-strict is in
   # effect.
   #include <abstractions/private-files-strict>
-  owner @{HOME}/** r,
+  owner @{HOME}/[a-zA-Z0-9]*    rw,
+  owner @{HOME}/[a-zA-Z0-9]*/** rw,
 
   # Not needed by nautilus, but maybe other applications
   owner /**.[pP][nN][gG] w,
