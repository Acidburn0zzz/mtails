#!/usr/bin/env python3

import argparse
import logging

import sh
from gi.repository import Gtk

from tails_server.gui.service import ServiceStatus
from tails_server.gui.gui import TailsServerGUI

sh.ErrorReturnCode.truncate_cap = 5000


def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument("--verbose", action="store_true")
    return parser.parse_args()


def init(args):
    if args.verbose:
        logging.basicConfig(level=logging.DEBUG)
    else:
        logging.basicConfig(level=logging.INFO)
    logging.debug("args: %r", args)


def main():
    args = parse_args()
    init(args)
    ServiceStatus.register_signal()
    TailsServerGUI()
    Gtk.main()

if __name__ == "__main__":
    main()
