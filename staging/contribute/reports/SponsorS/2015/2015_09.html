<!DOCTYPE html>

<html lang="en" dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tails - Tails September 2015 report</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="icon" href="../../../../favicon.ico" type="image/x-icon" />

<link rel="stylesheet" href="../../../../style.css" type="text/css" />

<link rel="stylesheet" href="../../../../local.css" type="text/css" />


<script src="../../../../lib/js/mirror-dispatcher.js" type="text/javascript"></script>









</head>


<body class="en">


<div class="searchform">



</div>

<div class="banner" role="banner">
  <a class="tails" href="../../../../index.en.html">
    <span class="acronym">Tails</span><br/>
    <span class="slogan">The Amnesic Incognito Live System</span>
  </a>
</div>

<div class="page">

<div class="pageheader">
<div class="header">
<span>
<span class="parentlinks">
<ul id="crumbs">
<li><a href="../../../../index.en.html"><img src="../../../../lib/home.png"></a></li>







<li><a href="../../../../contribute.en.html">contribute</a></li>





<li><a href="../../../reports.html">reports</a></li>





<li><a href="../../SponsorS.html">SponsorS</a></li>





<li><a href="../../../../index.en.html">2015</a></li>




<li>Tails September 2015 report</li>

</ul>
</span>
<span class="title">
Tails September 2015 report
</span>
</span>
</div>










</div>



<div class="sidebar" role="navigation">
<div class="download button">
  <a href="../../../../install.en.html"><span class="download">Install</span>
    <span class="tails">Tails 
3.9
</span>
    <span class="date">
2018-09-05</span></a>
</div>




<div class="links">
  <ul>
    <li><a href="../../../../about.en.html">About</a></li>
    <li><a href="../../../../getting_started.en.html">Getting started…</a></li>
    <li><a href="../../../../doc.en.html">Documentation</a></li>
    <li><a href="../../../../support.en.html">Help &amp; Support</a></li>
    <li><a href="../../../../contribute.en.html">Contribute</a></li>
    <li><a href="../../../../news.en.html">News</a></li>
  </ul>
</div>




<div class="donate button">
    <a href="https://tails.boum.org/donate?r=sidebar">Donate</a>
</div>


</div>



<div id="pagebody">

<div id="content" role="main">


<div class="toc">
<ol>
	<li class="L1"><a href="#index1h1">A. Replace Claws Mail with Icedove</a>
	</li>
	<li class="L1"><a href="#index2h1">B. Improve our quality assurance process</a>
	<ol>
		<li class="L2"><a href="#index1h2">B.2. Continuously run our entire test suite on all those ISO images once they are built</a>
		</li>
		<li class="L2"><a href="#index2h2">B.3 Extend the coverage of our test suite</a>
		</li>
		<li class="L2"><a href="#index3h2">B.3.6. Fix newly identified issues to make our test suite more robust and faster</a>
		</li>
	</ol>
	</li>
	<li class="L1"><a href="#index3h1">C. Scale our infrastructure</a>
	<ol>
		<li class="L2"><a href="#index4h2">C.1. Change in depth the infrastructure of our pool of mirrors</a>
		</li>
		<li class="L2"><a href="#index5h2">C.2. Be able to detect within hours failures and malfunction on our services</a>
		</li>
		<li class="L2"><a href="#index6h2">C.4. Maintain our already existing services</a>
		</li>
	</ol>
	</li>
	<li class="L1"><a href="#index4h1">D. Migration to Debian Jessie</a>
	<ol>
		<li class="L2"><a href="#index7h2">D.1. Adjust to the change of desktop environment to GNOME Shell</a>
		</li>
		<li class="L2"><a href="#index8h2">D.6. Upgrade Tails-specific tools to Debian Jessie technologies</a>
		</li>
		<li class="L2"><a href="#index9h2">Additional improvements that were not planned</a>
		</li>
	</ol>
	</li>
	<li class="L1"><a href="#index5h1">E. Release management</a>
	</li>
</ol>
</div>


<p>This reports covers the activity of Tails in September 2015.</p>

<p>Everything in this report can be made public.</p>

<h1><a name="index1h1"></a>A. Replace Claws Mail with Icedove</h1>

<ul>
<li><p>A.1.3. Integrate Icedove into Tails</p>

<p>We amended the strategy we had in mind initially and made it more
incremental. If time allows, a first stage will be to include
Icedove in Tails 1.7 (2015-11-03), but without the Icedove account
setup wizard. During this first stage, Torbirdy's own account setup
wizard will be used. And the second stage will be about securing
Icedove's wizard (<a href="https://labs.riseup.net/code/issues/6154">#6154</a>). If this works out as we hope, Tails users
will be able to start using Icedove two months earlier than what we
planned initially, and the transition period from Claws Mail will be
longer, and thus smoother, for users.</p>

<p>We started implementing this plan (<a href="https://labs.riseup.net/code/issues/10285">#10285</a>), set up team coordination
tools, and triaged what is a blocker for the first stage, from what is
not.</p>

<p>Then we worked on the "Torbirdy uses Arabic as a default locale"
bug, submitted a pull request upstream, that was accepted (<a href="https://labs.riseup.net/code/issues/9821">#9821</a>).</p></li>
<li><p>A.1.4. Provide a migration path for our users from Claws Mail to Icedove</p>

<p>We decided how long to keep Claws Mails once we have Icedove
(<a href="https://labs.riseup.net/code/issues/10010">#10010</a>), and initiated work on the migration for users of Tails
persistence feature (<a href="https://labs.riseup.net/code/issues/9498">#9498</a>).</p></li>
</ul>


<h1><a name="index2h1"></a>B. Improve our quality assurance process</h1>

<h2><a name="index1h2"></a>B.2. Continuously run our entire test suite on all those ISO images once they are built</h2>

<ul>
<li><p>B.2.1. Adjust our infrastructure to run tests in parallel</p>

<p>Great progress was made on this front, and more specifically on the
last remaining chunk of it: firing up a clean test runner virtual
machine before each test suite run. It was tricky to implement this in
a way that prevented race conditions, but we now have a working
prototype that we are confident fixes the issues we have seen earlier
(<a href="https://labs.riseup.net/code/issues/9486">#9486</a>, <a href="https://labs.riseup.net/code/issues/10215">#10215</a>). Along the way we encouraged a few Debian developers
to take care of a package we rely on (<code>jenkins-job-builder</code>), and one
of them promptly took it over and updated it to the version we need
(<a href="https://labs.riseup.net/code/issues/9646">#9646</a>).</p></li>
<li><p>B.2.2. Decide what kind of ISO images qualify for testing and when,
how to process, advertise, and store the results (<a href="https://labs.riseup.net/code/issues/8667">#8667</a>)</p>

<p>Early in September, we reached an agreement on all discussion topics
that were left pending in August, such as how to archive videos from
test suite runs. As can be seen in the "Help Jenkins integration"
section below, our test suite team promptly started adjusting their
code to match what we will need on the Jenkins deployment.</p>

<p><a href="https://tails.boum.org/blueprint/automated_builds_and_tests/automated_tests_specs/">https://tails.boum.org/blueprint/automated_builds_and_tests/automated_tests_specs/</a></p></li>
<li><p>B.2.3. Research and design a solution to generate a set of Jenkins ISO test jobs</p>

<p>Some research and experiments were done for sending ISO images that
shall be tested to the test suite runner virtual machines (<a href="https://labs.riseup.net/code/issues/9597">#9597</a>), and
major blockers were removed in the underlying infrastructure.  Some of
our Puppet code saw a nice refactoring in this process.  On the same
topic, we reached a consensus regarding what "old" ISO image to use
for tests that require two images, such as upgrade tests (<a href="https://labs.riseup.net/code/issues/10117">#10117</a>). And
here as well, test suite developers promptly implemented what we
needed (<a href="https://labs.riseup.net/code/issues/10147">#10147</a>).</p>

<p><a href="https://tails.boum.org/blueprint/automated_builds_and_tests/jenkins/">https://tails.boum.org/blueprint/automated_builds_and_tests/jenkins/</a></p></li>
</ul>


<h2><a name="index2h2"></a>B.3 Extend the coverage of our test suite</h2>

<h3><a name="index1h3"></a>General improvements</h3>

<ul>
<li><p>Filesystem shares are incompatible with QEMU snapshots: <a href="https://labs.riseup.net/code/issues/5571">#5571</a></p>

<p>We have come up with a short-term strategy that will work well with
our current workflow. In addition we have our eyes on a long-term
technical solution that will require adding a small feature into
upstream QEMU. This is, however, out of the scope of this
deliverable.</p></li>
</ul>


<h3><a name="index2h3"></a>Help Jenkins integration</h3>

<p>These changes, on the test suite side, were prompted by the ongoing
work on "B.2. Continuously run our entire test suite on all those ISO
images once they are built".</p>

<p>It should be noted that many of the things mentioned here also greatly
assist developers when debugging the automated test suite.</p>

<ul>
<li><p>Leverage Cucumber's formatter system for debug logging: <a href="https://labs.riseup.net/code/issues/9491">#9491</a></p>

<p>This makes it easier to have clean console logging while still
keeping the full debug log in a separate file. Consequently it will
be easier to get an overview of how a test is currently running.</p></li>
<li><p>Capture individual videos for failed scenarios only: <a href="https://labs.riseup.net/code/issues/10148">#10148</a></p>

<p>This will both make these video artifacts more manageable and useful
for the developers (more focused, better granularity), and will save
a lot of disk space on our servers by excluding videos of tests that
succeeded and hence aren't very interesting.</p></li>
<li><p>Make the old Tails ISO default to the "new" ISO: <a href="https://labs.riseup.net/code/issues/10147">#10147</a></p>

<p>This compromise will test 90% of what we want to test, and simplify
the Jenkins setup by eliminating the need to share multiple ISO
artifacts to the test suite context.</p></li>
</ul>


<h2><a name="index3h2"></a>B.3.6. Fix newly identified issues to make our test suite more robust and faster</h2>

<h3><a name="index3h3"></a>Performance improvements</h3>

<ul>
<li><p>Snapshot improvements: <a href="https://labs.riseup.net/code/issues/6094">#6094</a>, <a href="https://labs.riseup.net/code/issues/8008">#8008</a></p>

<p>The proof-of-concept that was written as part of B.3.4 has matured
into a reliable implementation and
it is basically done; only fine-tuning and style improvements
remain. It is expected to be ready for the Jenkins deployment in
Milestone III, and will allow us to run 33% more tests. It will add
less overhead for new tests using persistence in the future, and
thus complete "B.3.9. Optimize tests that need a persistent volume"
three months in advance.</p></li>
<li><p>Use the more efficient x264 encoding when capturing videos: <a href="https://labs.riseup.net/code/issues/10001">#10001</a></p>

<p>This will reduce the CPU load on the host running the automated test
suite, as well as reduce its runtime with a few percent.</p></li>
<li><p>Optimize IRC test using waitAny: <a href="https://labs.riseup.net/code/issues/9653">#9653</a></p>

<p>In case there are connection issues, this may save several minutes
per instance by waiting for both the failure and success condition
in parallel, instead of serially.</p></li>
</ul>


<h3><a name="index4h3"></a>Robustness improvements</h3>

<p>Some of what follows was part of a project we have with
another sponsor.</p>

<ul>
<li><p>Avoid nested FindFailed exceptions in waitAny()/findAny(): <a href="https://labs.riseup.net/code/issues/9633">#9633</a></p>

<p>This works around a race condition due to a bug in Rjb that made
these helpers fail with some probability depending on the host
hardware.</p></li>
<li><p>Import logging module in otr-bot.py: <a href="https://labs.riseup.net/code/issues/9375">#9375</a></p>

<p>Without this fix, the bot may occasionally fail due to it wanting to
use the logging facility when it is not in place.</p></li>
<li><p>Force new Tor circuit and reload web site on browser
timeouts: <a href="https://labs.riseup.net/code/issues/10116">#10116</a></p>

<p>Given the inherent instability of Tor circuits, this will
drastically improve the robustness of all Tor Browser tests.</p></li>
<li><p>Pidgin's multi-window GUI sometimes causes unexpected behaviour
(e.g. one window covering the window we want to interact with):</p>

<ul>
<li><p>Focus Pidgin's buddy list before trying to access the tools
menu: <a href="https://labs.riseup.net/code/issues/10217">#10217</a></p></li>
<li><p>Wait for (and focus if necessary) Pidgin's Certificate windows: <a href="https://labs.riseup.net/code/issues/10222">#10222</a></p></li>
</ul>
</li>
<li><p>Develop a strategy for dealing with newly discovered fragile tests: <a href="https://labs.riseup.net/code/issues/10288">#10288</a></p>

<p>By leveraging our Jenkins instance, following this strategy will
isolate individual robustness issues into individual branches while
keeping all other branches functional. Consequently it will be
easier to track and deal with future robustness issues.</p></li>
<li><p>Escape regexp used to match nick in CTCP replies: <a href="https://labs.riseup.net/code/issues/10219">#10219</a></p>

<p>Due to how we randomize the nick name for the default Pidgin
accounts, there was a 10% chance to generate one with characters
that would have a special meaning when used inside regular
expressions, causing failures.</p></li>
</ul>


<h3><a name="index5h3"></a>Writing more automated tests</h3>

<ul>
<li><p>B.3.8. Automatically test that udev-watchdog is monitoring the
right device: <a href="https://labs.riseup.net/code/issues/9890">#9890</a>.</p>

<p>This was completed and merged almost four months ahead of schedule.</p></li>
</ul>


<h1><a name="index3h1"></a>C. Scale our infrastructure</h1>

<h2><a name="index4h2"></a>C.1. Change in depth the infrastructure of our pool of mirrors</h2>

<p>We started working on this project, and decided to handle the
redirection on the client's side (for the record, the original plan
was to do it server-side). We quickly put together a very rough
proof-of-concept, and then moved on to update our plans for the next
steps, accordingly to our new technological choice.</p>

<p>The big picture is described on the corresponding blueprint:
<a href="https://tails.boum.org/blueprint/HTTP_mirror_pool/">https://tails.boum.org/blueprint/HTTP_mirror_pool/</a></p>

<ul>
<li><p>C.1.1. Specify a way of describing the pool of mirrors</p>

<p>We picked a serialization format (JSON) that matches our
implementation choices, and started researching what would be the
best naming scheme for mirrors, taking into account future HTTPS
hardening we have in mind, and support in various popular web
servers (<a href="https://labs.riseup.net/code/issues/10294">#10294</a>).</p></li>
<li><p>C.1.3. Design and implement the mirrors pool administration process and tools</p>

<p>We settled on ikiwiki overlays for integration into our website, and
on using Git and SSH to store and convey the configuration (<a href="https://labs.riseup.net/code/issues/8637">#8637</a>).</p></li>
<li><p>C.1.2. Write &amp; audit the code that makes the redirection decision</p>

<p>We did some prototyping work (<a href="https://labs.riseup.net/code/issues/8639">#8639</a>), and then started refactoring
it so that the code can be reused by other components that will need
to implement the same redirection scheme client-side (<a href="https://labs.riseup.net/code/issues/10284">#10284</a>).</p></li>
</ul>


<h2><a name="index5h2"></a>C.2. Be able to detect within hours failures and malfunction on our services</h2>

<p>This deliverable is technically due for January 15, but we kept on
working on it.</p>

<ul>
<li><p>C.2.1. Research and decide what monitoring solution to use: <a href="https://labs.riseup.net/code/issues/8645">#8645</a></p>

<p>We completed experiments and comparisons between monitoring systems,
and settled on Icinga 2. We started looking for solutions regarding
the single requirement of ours that it does not satisfy.</p>

<p><a href="https://tails.boum.org/blueprint/monitor_servers/">https://tails.boum.org/blueprint/monitor_servers/</a></p></li>
<li><p>C.2.2. Set up the monitoring software and the underlying
infrastructure: <a href="https://labs.riseup.net/code/issues/8646">#8646</a>, <a href="https://labs.riseup.net/code/issues/8647">#8647</a></p>

<p>We found hosting for our monitoring setup, got access to the
machine, and installed an operating system on it.</p></li>
</ul>


<h2><a name="index6h2"></a>C.4. Maintain our already existing services</h2>

<ul>
<li><p>C.4.3. Administer our services upto milestone III</p>

<p>Aside of the usual security updates and taking care of daily requests
coming from the Tails development community, we did some resources
planning, and updated the system requirements for the VM that will be
used as a failover for our critical services (<a href="https://labs.riseup.net/code/issues/10243">#10243</a>) and looked for
hosting that would meet our needs (<a href="https://labs.riseup.net/code/issues/10244">#10244</a>). We have an initial
agreement with a hosting organization, and will follow-up on
this shortly.</p></li>
</ul>


<h1><a name="index4h1"></a>D. Migration to Debian Jessie</h1>

<h2><a name="index7h2"></a>D.1. Adjust to the change of desktop environment to GNOME Shell</h2>

<ul>
<li><p>D.1.1. Adjust to the change of desktop environment to GNOME Shell</p>

<p>We completed the work started on our "Shutdown helper" applet for
Jessie (<a href="https://labs.riseup.net/code/issues/8302">#8302</a>): visually impaired users can now use it, and we made
sure it is integrated with our translation system.</p>

<p>We cleaned up the desktop Applications menu (<a href="https://labs.riseup.net/code/issues/8505">#8505</a>).</p></li>
</ul>


<h2><a name="index8h2"></a>D.6. Upgrade Tails-specific tools to Debian Jessie technologies</h2>

<ul>
<li><p>D.6.1. Port Tails-specific tools from udisks 1 to udisks 2</p>

<p>We followed up on the persistent volume assistant's porting to
udisks 2, and made sure it does not trigger spurious GNOME
notifications that could confuse users (<a href="https://labs.riseup.net/code/issues/9280">#9280</a>).</p></li>
<li><p>D.6.3. Port WhisperBack, our integrated bug reporting tool, to Python 3</p>

<p>Native SOCKS support was completed, which was the only missing piece
to make WhisperBack work great on Jessie and Python 3 (<a href="https://labs.riseup.net/code/issues/9412">#9412</a>).</p></li>
</ul>


<h2><a name="index9h2"></a>Additional improvements that were not planned</h2>

<ul>
<li><p>When starting Tails in a virtual machine that runs with non-free
technology (and does not hide this fact), users are now warned about
the risks (<a href="https://labs.riseup.net/code/issues/5315">#5315</a>).</p></li>
<li><p>Simplify printers administration: it can now be done without having
to set an administration password, just like it was back when Tails
was based on Debian Squeeze (<a href="https://labs.riseup.net/code/issues/8443">#8443</a>). This removes a usability
pain-point, namely the need to restart Tails when one realizes too
late they need to print a document, and should have set an
administration password. In passing, we noticed that AppArmor
blocked adding a printer on Jessie, and fixed it (<a href="https://labs.riseup.net/code/issues/10210">#10210</a>).</p></li>
</ul>


<h1><a name="index5h1"></a>E. Release management</h1>

<ul>
<li><p><a href="../../../../news/version_1.6.html">Tails 1.6</a> was released on 2015-09-22:</p>

<ul>
<li>Upgrade Tor Browser to version 5.0.3 (based on Firefox 38.3.0 ESR).</li>
<li>Upgrade I2P to version 0.9.22 and enable its AppArmor profile.</li>
<li>Fix several issues related to MAC address spoofing:

<ul>
<li>If MAC address spoofing fails on a network interface and this
interface cannot be disabled, then all networking is now
completely disabled.</li>
<li>A notification is displayed if MAC address spoofing causes
network issues, for example if a network only allows
connections from a list of authorized MAC addresses.</li>
</ul>
</li>
</ul>
</li>
</ul>


</div>







</div>

<div id="footer" class="pagefooter" role="contentinfo">

<div id="pageinfo">












</div>
<div id="mirrorlist">Mirror: <a href="https://tails.boum.org/ikiwiki.cgi?do=goto&page=contribute/reports/SponsorS/2015/2015_09">tails.boum.org</a></div>

<!-- from The Amnesic Incognito Live System -->
</div>

</div>

<script type="text/javascript">
  var linkelements = document.querySelectorAll('.use-mirror-pool');
  if(linkelements.length > 0) {
    replaceUrlPrefixWithRandomMirror(linkelements);
  }
</script>

</body>
</html>
