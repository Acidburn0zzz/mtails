<!DOCTYPE html>

<html lang="en" dir="ltr" xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tails - Set up a Tails mirror</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="icon" href="../../favicon.ico" type="image/x-icon" />

<link rel="stylesheet" href="../../style.css" type="text/css" />

<link rel="stylesheet" href="../../local.css" type="text/css" />


<script src="../../lib/js/mirror-dispatcher.js" type="text/javascript"></script>









</head>


<body class="en">


<div class="searchform">



</div>

<div class="banner" role="banner">
  <a class="tails" href="../../index.en.html">
    <span class="acronym">Tails</span><br/>
    <span class="slogan">The Amnesic Incognito Live System</span>
  </a>
</div>

<div class="page">

<div class="pageheader">
<div class="header">
<span>
<span class="parentlinks">
<ul id="crumbs">
<li><a href="../../index.en.html"><img src="../../lib/home.png"></a></li>







<li><a href="../../contribute.en.html">contribute</a></li>





<li><a href="../how.html">how</a></li>




<li>Set up a Tails mirror</li>

</ul>
</span>
<span class="title">
Set up a Tails mirror
</span>
</span>
</div>










</div>



<div class="sidebar" role="navigation">
<div class="download button">
  <a href="../../install.en.html"><span class="download">Install</span>
    <span class="tails">Tails 
3.9
</span>
    <span class="date">
2018-09-05</span></a>
</div>




<div class="links">
  <ul>
    <li><a href="../../about.en.html">About</a></li>
    <li><a href="../../getting_started.en.html">Getting startedâ€¦</a></li>
    <li><a href="../../doc.en.html">Documentation</a></li>
    <li><a href="../../support.en.html">Help &amp; Support</a></li>
    <li><a href="../../contribute.en.html">Contribute</a></li>
    <li><a href="../../news.en.html">News</a></li>
  </ul>
</div>




<div class="donate button">
    <a href="https://tails.boum.org/donate?r=sidebar">Donate</a>
</div>


</div>



<div id="pagebody">

<div id="content" role="main">


<div id="intro">

<p>Setting up a Tails BitTorrent or HTTPS mirror helps Tails users
downloading it faster and more reliably.</p>


<div class="toc">
<ol>
	<li class="L1"><a href="#index1h1">BitTorrent</a>
	<ol>
		<li class="L2"><a href="#index1h2">1. Get the latest BitTorrent files</a>
		</li>
		<li class="L2"><a href="#index2h2">2. Share Tails images</a>
		</li>
		<li class="L2"><a href="#index3h2">3. Stay tuned!</a>
		</li>
	</ol>
	</li>
	<li class="L1"><a href="#index2h1">HTTPS</a>
	<ol>
		<li class="L2"><a href="#index4h2">The big picture</a>
		</li>
		<li class="L2"><a href="#index5h2">Pick a hostname for your mirror</a>
		</li>
		<li class="L2"><a href="#index6h2">Manual set up</a>
		</li>
		<li class="L2"><a href="#index7h2">Set up with Puppet</a>
		</li>
		<li class="L2"><a href="#index8h2">Go wild: ask for your mirror to be added to the pool</a>
		</li>
	</ol>
	</li>
	<li class="L1"><a href="#index3h1">Talk to us</a>
	</li>
</ol>
</div>


</div>


<h1><a name="index1h1"></a>BitTorrent</h1>

<p>It's really easy to help Tails users downloading it over BitTorrent...
especially if you are already a BitTorrent user.</p>

<h2><a name="index1h2"></a>1. Get the latest BitTorrent files</h2>

<p>Here are the latest available BitTorrent files:</p>

<div class="map">
<ul>
<li>
<a href="../../torrents/files/tails-amd64-3.9.torrent" class="mapitem">tails-amd64-3.9.torrent</a>
</li>
<li>
<a href="../../torrents/files/tails-amd64-3.9~rc1.torrent" class="mapitem">tails-amd64-3.9~rc1.torrent</a>
</li>
</ul>
</div>


<h2><a name="index2h2"></a>2. Share Tails images</h2>

<p>Feed your preferred BitTorrent client with the <code>.torrent</code> files
downloaded at the previous step. Make sure you open and/or forward the
needed ports in your router and/or firewall configuration so that you
are a real seed.</p>

<h2><a name="index3h2"></a>3. Stay tuned!</h2>

<p>As a contributor to Tails availability over BitTorrent, it is very
important you share the very latest published version, and only this
one: users need to be able to quickly download it and upgrade when we
release security fixes, and there is no need to help propagate
outdated versions with security flaws.</p>

<p>A way to do this is to configure software to <a href="./mirror/automatically_download_and_seed_Tails_over_BitTorrent.html">automatically download
and seed Tails over
BitTorrent</a>.</p>

<p>Else, new versions are announced on:</p>

<ul>
<li>our <a href="../../about/contact.en.html#amnesia-news">news list</a></li>
<li>our <a href="/torrents/rss/index.rss">RSS</a> and
<a href="/torrents/rss/index.atom">Atom</a> feeds that announce new available
BitTorrent files.</li>
</ul>


<p><a id="http"></a>
<a id="https"></a></p>

<h1><a name="index2h1"></a>HTTPS</h1>

<p>To efficiently help Tails users downloading it over HTTPS, one needs to
have sufficiently privileged access to a web server with decent
bandwidth: a domestic DSL connection won't help; neither will a shared
web hosting setup that provides FTP access only.</p>

<p>To give you an idea, a few dedicated Mb/s is a must; you must expect
pushing at least <strong>50-100GB</strong> <a href="https://en.wikipedia.org/wiki/GiB">GiB</a> (bytes, not bits) on
a normal day, and twice as much for a short period after each release.
So, it is a must to be able to push <strong>at least 5 <a href="https://en.wikipedia.org/wiki/TiB">TiB</a></strong>
a month, and <strong>preferably 6 or 8 TiB</strong>.</p>

<p>You will also need <strong>30 GiB</strong> maximum of disk space.</p>

<p>Please provide an unfiltered access to your server (no GeoIP
blocking, no IP bans, no CAPTCHAs, etc.) as we want people everywhere
to be able to download Tails.</p>

<p>If you satisfy these practical requirements, please read on!
Else, please consider seeding Tails images over BitTorrent instead.</p>

<p>Before starting doing any real work on this topic, you may want to get in touch
(<a href="mailto:tails-mirrors@boum.org">&#116;&#97;&#105;&#108;&#115;&#45;&#109;&#105;&#114;&#114;&#111;&#114;&#115;&#64;&#98;&#111;&#117;&#109;&#46;&#111;&#114;&#103;</a>, <a href="../../doc/about/openpgp_keys.en.html#mirrors">OpenPGP key</a>) and send us
your OpenPGP public key, so that any further communication between us
can be properly encrypted and authenticated.</p>

<h2><a name="index4h2"></a>The big picture</h2>

<p>All downloads are currently served from a diverse pool of mirrors
(see the <a href="../design/mirrors.html">design document</a> for details).</p>

<p>Every HTTPS mirror makes our files available under a fixed URL
(e.g. <code>https://42.dl.amnesia.boum.org/tails/</code> or <code>https://yourdomain.org/pub/tails/</code>)
that contains per-version sub-directories (such as
<code>https://42.dl.amnesia.boum.org/tails/stable/tails-i386-lenny-0.6.2/</code>).</p>

<p>Alongside our mirror pool redirecting to mirrors using their own domain, we maintain
a DNS Round Robin pool for the <code>dl.amnesia.boum.org</code> host. This pool serves as a
fallback, we add only a few fast and reliable mirrors to it.</p>

<p>We only accept mirrors that provide a SSL certificate deemed valid by
Firefox for the exact hostname used.</p>

<h2><a name="index5h2"></a>Pick a hostname for your mirror</h2>

<p>Your web server needs to answer HTTP and HTTPS requests sent to
a <em>dedicated</em> hostname that is unique, within our mirror pool.
Furthermore, your web server should answer requests sent to <code>dl.amnesia.boum.org</code>
(your mirror could be added to our fallback mirror pool at any moment).</p>

<p>There are two ways to pick that dedicated hostname:</p>

<ol>
<li><p>Use a hostname of your choice, under a domain you control.
For example, if you control <code>example.com</code>, you can call your Tails
mirror <code>tails.example.com</code>. This is, by far, our preferred option:</p>

<ul>
<li>it allows you to maintain that DNS record yourself, e.g. whenever you
need to update your mirror's IP address;</li>
<li>it saves us a lot of work :)</li>
</ul>
</li>
<li><p>Use a hostname of our choice, under <code>dl.amnesia.boum.org</code> (e.g.
you may get <code>142.dl.amnesia.boum.org</code>). To do so, at the end of
this set of instructions, when it's time to ask us to add your
mirror to the pool, also ask us to create a dedicated hostname
for you.</p></li>
</ol>


<h2><a name="index6h2"></a>Manual set up</h2>

<div class="tip">
If you are using <a href="https://en.wikipedia.org/wiki/Puppet%5F%28software%29">Puppet</a> to configure
your server infrastructure, consider using the available <a href="./mirror.html#http-puppet">HTTP mirror Puppet
module</a>.
</div>


<h3><a name="index1h3"></a>1. Set up your web server</h3>

<p>Set up a virtual host for the hostname chosen at the
previous step. The virtual host will need to
have indexing enabled.</p>

<p>Files must be served over HTTP and HTTPS. To be helpful in our
context, this requires a certificate that is considered valid by
mainstream web browsers; you can get such a certificate free of charge,
from <a href="https://letsencrypt.org/">Let's Encrypt</a> for example.</p>

<h4><a name="index1h4"></a>Apache configuration example</h4>

<pre><code>&lt;VirtualHost YOUR_WEBSERVER_IP:80&gt;
   ServerName yourdomain.org
   ServerAlias dl.amnesia.boum.org
   ServerAlias *.dl.amnesia.boum.org
   RewriteEngine On
   RewriteRule ^/?(.*) https://%{SERVER_NAME}/pub/$1 [R=permanent,L]
&lt;/VirtualHost&gt;

&lt;VirtualHost YOUR_WEBSERVER_IP:443&gt;
   ServerName yourdomain.org
   ServerAdmin YOUR_EMAIL

   SSLEngine on
   SSLCertificateFile /etc/apache2/ssl/apache.crt
   SSLCertificateKeyFile /etc/apache2/ssl/apache.key

   DocumentRoot /var/www/YOUR_PATH/
   &lt;Directory /var/www/YOUR_PATH/&gt;
      Options Indexes
      AllowOverride None
      IndexIgnore README.html
      IndexOptions FancyIndexing FoldersFirst IgnoreCase NameWidth=50
      IndexOrderDefault Descending Date
   &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</code></pre>

<div class="tip">
You can harden this configuration using the
<a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">
Mozilla SSL Configuration Generator</a>.
</div>


<h4><a name="index2h4"></a>Lighttpd configuration example</h4>

<pre><code>$HTTP["host"] =~ "^(\d+\.)?dl\.amnesia\.boum\.org$" {
    server.document-root = "/var/www/YOUR_PATH/"
    server.dir-listing = "enable"
}
</code></pre>

<h4><a name="index3h4"></a>nginx configuration example</h4>

<pre><code>server {
    server_name dl.amnesia.boum.org *.dl.amnesia.boum.org;
    root /var/www/YOUR_PATH;
    location / {
        autoindex on;
    }
}
</code></pre>

<h3><a name="index2h3"></a>2. Download the files</h3>

<p>Download a snapshot of the current Tails files:</p>

<pre><code>rsync -rt --delete \
         mirrors.rsync.tails.boum.org::amnesia-archive /var/www/YOUR_PATH/
</code></pre>

<p><a id="cron"></a></p>

<h3><a name="index3h3"></a>3. Schedule the pulling of the files</h3>

<p>Your mirror should sync every hour + a random time (maximum 40 minutes).
Use <code>cron</code> or equivalent to schedule the same <code>rsync</code> command
as above.</p>

<pre><code>0 * * * * root sleep $(perl -E 'print int(rand(2400))') &amp;&amp; flock -n /var/run/lock/tails-mirror-rsync rsync -rt --delete mirrors.rsync.tails.boum.org::amnesia-archive /var/www/YOUR_PATH/
</code></pre>

<p>You can now <a href="./mirror.html#http-pool">ask for your mirror to be added to the pool</a>.</p>

<p><a id="http-puppet"></a></p>

<h2><a name="index7h2"></a>Set up with Puppet</h2>

<p>It is assumed that Puppet is already installed and configured to function well
for your infrastructure.</p>

<h3><a name="index4h3"></a>1. Clone the <code>tails</code> Puppet module</h3>

<p>Clone the module inside the puppet modules' directory of your puppetmaster. On
Debian, this directory should be <code>/etc/puppet/modules</code>.</p>

<pre><code> git clone https://git-tails.immerda.ch/puppet-tails /etc/puppet/modules/tails
</code></pre>

<h3><a name="index5h3"></a>2. Use the tails::mirror class</h3>

<p>On a node where you wish setup the mirror you should include the class like</p>

<pre><code> include tails::mirror
</code></pre>

<p>If you need to adjust any parameters of the class, you should declare it like</p>

<pre><code> class { 'tails::mirror':
   webserver   =&gt; 'apache2',
   server_name =&gt; 'tails.example.com',
   mirror_path =&gt; '/srv/tails/mirror',
 }
</code></pre>

<h4><a name="index4h4"></a>Configurable parameters</h4>

<p>See the documentation on top of
<a href="https://git-tails.immerda.ch/puppet-tails/tree/manifests/mirror.pp">the module</a>.</p>

<p><a id="http-pool"></a></p>

<h2><a name="index8h2"></a>Go wild: ask for your mirror to be added to the pool</h2>

<p>As soon as your web server is ready, please email us its IP address
so that we can add it to the Round Robin pool.</p>

<p>Also, if you decided to use a hostname under <code>dl.amnesia.boum.org</code>,
please ask us to create it at the same time.</p>

<div class="note">

We will publish your email address, associated with the URL of your
mirror, in a file hosted on our website. If you are not comfortable
with this, give us an email alias that we can publish without
revealing additional information, such as
webmaster@your-mirror.org.

</div>


<h1><a name="index3h1"></a>Talk to us</h1>

<p>You can subscribe to <a href="../../about/contact.en.html#tails-dev">tails-dev@boum.org</a>,
our development mailing list.</p>

</div>







</div>

<div id="footer" class="pagefooter" role="contentinfo">

<div id="pageinfo">







<div id="backlinks">
Pages linking to this one:

<a href="../../contribute.en.html">contribute</a>

<a href="../../contribute.ar.html">contribute.ar</a>

<a href="../../contribute.ca.html">contribute.ca</a>

<a href="../../contribute.de.html">contribute.de</a>

<a href="../../contribute.es.html">contribute.es</a>

<a href="../../contribute.fa.html">contribute.fa</a>

<a href="../../contribute.fr.html">contribute.fr</a>

<a href="../../contribute.it.html">contribute.it</a>

<a href="../../contribute.pl.html">contribute.pl</a>

<a href="../../contribute.pt.html">contribute.pt</a>


<span class="popup">...
<span class="balloon">

<a href="../../contribute.ru.html">contribute.ru</a>

<a href="../../contribute.sr_Latn.html">contribute.sr Latn</a>

<a href="../../contribute.tr.html">contribute.tr</a>

<a href="../../contribute.zh.html">contribute.zh</a>

<a href="../../contribute.zh_TW.html">contribute.zh TW</a>

<a href="../../news/report_2015_08.html">news/report 2015 08</a>

<a href="../../news/report_2016_04.html">news/report 2016 04</a>

</span>
</span>

</div>






</div>
<div id="mirrorlist">Mirror: <a href="https://tails.boum.org/ikiwiki.cgi?do=goto&page=contribute/how/mirror">tails.boum.org</a></div>

<!-- from The Amnesic Incognito Live System -->
</div>

</div>

<script type="text/javascript">
  var linkelements = document.querySelectorAll('.use-mirror-pool');
  if(linkelements.length > 0) {
    replaceUrlPrefixWithRandomMirror(linkelements);
  }
</script>

</body>
</html>
